# Configuration Guide

## Server Configuration

The server supports multiple configuration options that can be supplied as environment variables and/or configuration files.

### Server Environment Variables

| **Variable**            | **Description**                                                                                                                    | **Required** | **Default Value**   |
|-------------------------|------------------------------------------------------------------------------------------------------------------------------------|--------------|---------------------|
| OPENAI_API_KEY          | The key used to authenticate with OpenAI's API                                                                          | ✓            |                     |
| JWT_SECRET_KEY          | The secret key used by Flask to encode and decode JWTs                                                                             | ✓            |                     |
| SQLALCHEMY_DATABASE_URI | The database connection URI, for example sqlite:///sqlite.db or postgresql://sidekick_user:sidekick_password@127.0.0.1/sidekick_db | ✓            |  |
| LOG_LEVEL               | The miminum urgency of logs to write to standard out. Supported values: 'DEBUG', 'INFO', 'WARNING', 'ERROR', 'CRITICAL'.           |              | ERROR               |
| FLASK_DEBUG             | Whether or not to run the Flask app in debug mode. Supported values: 'True', 'False'.                                              |              | False               |

### System settings

System settings can be used to customise specific parts of the application by editing the content of files in the `server/system_settings` directory.
These can also be edited by the admin user via the Admin page.

## Database Configuration
The server uses SQLAlchemy to connect to a RDBMS system, ideally SQLite or Postgres. Set the database connection string via the SQLALCHEMY_DATABASE_URI environment variable.

The app also uses Flask-Migrate to generate and apply database migrations. Migrations are stored in the `server/migrations/` directory. Migrations are generated by making changes to `server/models.py` and running the command `pipenv run flask db migrate -m "<Migration Description>"`. This will create a new migration in the `server/migrations/` directory. The app will automatically attempt to apply a migration when first starting up if the database engine is postgresql. Alternatively, manually upgrading the database with the latest migrations can be done by running `pipenv run flask db upgrade`. 